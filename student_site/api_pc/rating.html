<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="barger.jpg">

    <title>澳門大學飯堂評分</title>

    <!-- Bootstrap core CSS -->
    <link href="a1.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="a2.css" rel="stylesheet">
  </head>

  <body>
	<style>
		.bg-dark {
			background-color: #AEA17F!important; 
		}
		.container_b{
			background-image: url("water.jpg");
		}
		.first{
			background-image: url("food3.jpg");
			background-repeat: no-repeat;
			float:left;
		}
		.second{
			background-image: url("food4.jpg");
			background-repeat: no-repeat;
			float:right;
		}
		p{
			background-color: transparent;
		}
		.abc{
			color: #FFFFFF!important;
			text-shadow: 3px 2px blue;
		}
		.efg{
			color: #FFFFFF!important;
			text-shadow: 3px 2px red;
		}
		.hello{
			color: #FFFFFF!important;

		}
		.buttonBar{
			width:310px;
			height:50px;
		}
		.barchart{
			background-color: lightblue;
		}
		.button_a{
			background-color: #CE488B;
			color:#FFFFFF;
		}
		.button_b{
			background-color: #4894CE;
			color:#FFFFFF;
		}
		.button_c{
			background-color: #E2D23E;
			color:#FFFFFF;
		}
		.button_d{
			background-color: #30E27D;
			color:#FFFFFF;
		}
		.button_e{
			background-color: #E2A130;
			color:#FFFFFF;
		}
	</style>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	
	<header>
      <div class="collapse bg-dark" id="navbarHeader">
        <div class="container">
          <div class="row">
            <div class="col-sm-8 col-md-7 py-4">
              <h4 class="text-white">關於:</h4>
              <p class="text-muted hello">你可以在這個網站中，幫食物評分，而你的評分會有利於我們改善和分配食物，謝謝</p>
            </div>
            <div class="col-sm-4 offset-md-1 py-4">
              <h4 class="text-white">Contact</h4>
              <ul class="list-unstyled">
                <li><a href="#" class="text-white">+853 8822 8833</a></li>
                <li><a href="#" class="text-white">地址: 中國澳門氹仔 大學大馬路 澳門大學</a></li>
                <li><a href="#" class="text-white">Email us: info@umac.mo</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="navbar navbar-dark bg-dark shadow-sm">
        <div class="container d-flex justify-content-between">
          <a href="#" class="navbar-brand d-flex align-items-center">
            
            <strong>澳門大學飯堂評分</strong>
          </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarHeader" aria-controls="navbarHeader" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
        </div>
      </div>
    </header>

    <main role="main">
      <section class="jumbotron text-center container_a" style="background-image: url(food.jpg)">
		<div class="first"></div>
		<div class="second"></div>
		<div></div>
		<div>
        <div class="container">
          <h1 class="jumbotron-heading efg">飯堂評分</h1>
          <p class="lead text-muted abc" >澳門大學</p>
        </div>
      </section>
	  </div>
	  
		<div class="barchart" style="text-align:center">
			
			<a href="index.html">
				<button id="LunchDrinkSon"class="buttonBar button_a"onclick="onclick_button1">主頁</button>
			</a>
			
			<a href="#">
				<button id="rade"class="buttonBar button_b " onclick="onclick_button2">飯堂評分</button>
				
			</a>
		
			<div class="dropdown" style="display:inline">
				<button class=" dropdown-toggle buttonBar button_d" type="button" data-toggle="dropdown">統計人次
					<span class="caret"></span>
				</button>
						<ul class="dropdown-menu" style="text-align:center">
							<li><a href="../chart/barchart(b).php">早餐</a></li>
							<li><a href="../chart/barchart(l).php">午餐</a></li>
							<li><a href="../chart/barchart(d).php">晚餐</a></li>
						</ul>
			</div>
			</a>

		</div>

      <div class="album py-5 bg-light">
        <div class="container_b">

          <div class="row" id="custom_content">
		

            <!--
			<div class="col-md-4">
              <div class="card mb-4 shadow-sm">
                <img class="card-img-top" data-src="holder.js/100px225?theme=thumb&bg=55595c&fg=eceeef&text=Thumbnail" alt="Card image cap" id="poster">
                <div class="card-body">
					<p class="card-text">香爆肉丁飯</p>
					<div class="d-flex justify-content-between align-items-center">
                    <div class="btn-group">
						<button type="button" class="btn btn-sm btn-outline-secondary">View</button>
                    </div>
                    <small class="text-muted">材料和評分</small>
                  </div>
                </div>
              </div>
            </div>
			-->

			
          </div>
        </div>
      </div>

    </main>
	
	 <!-- The Modal -->
  <div class="modal fade" id="myModal">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
      
        <!-- Modal Header -->
        <div class="modal-header">
          <h4 class="modal-title" >rate</h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        
        <!-- Modal body -->
        <div class="modal-body">
			<span id ="btn_star1"onclick="onclick_star_a(event)"class="fa fa-star a"></span>
			<span id ="btn_star2"onclick="onclick_star_b(event)"class="fa fa-star b"></span>
			<span id ="btn_star3"onclick="onclick_star_c(event)"class="fa fa-star c"></span>
			<span id ="btn_star4"onclick="onclick_star_d(event)"class="fa fa-star d"></span>
			<span id ="btn_star5"onclick="onclick_star_e(event)"class="fa fa-star e"></span>
			<button onclick="onclick_sumit(event)"id="sumit"class="sumit">Sumit</button>
		
        </div>
        
        <!-- Modal footer -->
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
        
      </div>
    </div>

    <footer class="text-muted">
      <div class="container">
        <p class="float-right">
          <a href="#">Back to top</a>
        </p>
      </div>
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="a3.js" ></script>
    <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <script src="a4.js"></script>
    <script src="a5.js"></script>
    <script src="a6.js"></script>
	<script>
		$.ajax({
			method:"GET",
			url:"../menu/getmenu.php",
		}).done(function (response){
			console.log(response);
			if (response!=null){
			var text=""
			for (var i=0;i<response.length;i++){
				text += "<div class='col-md-4'>";
				text += '<div class="card mb-4 shadow-sm">';
				text += '<img class="card-img-top" src= "../../cafeteria_site/todaymenu/'+response[i]["photo"]+'" alt="Card image cap" id="poster">';
				text += '<div class="card-body">';
				text +=	'<p class="card-text">'+response[i]["name"]+'</p>';
				
				text += '<span class="fa fa-star a" id=star'+ i +'_1></span>'
				text += '<span class="fa fa-star a" id=star'+ i +'_2></span>'
				text += '<span class="fa fa-star a" id=star'+ i +'_3></span>'
				text += '<span class="fa fa-star a" id=star'+ i +'_4></span>'
				text += '<span class="fa fa-star a" id=star'+ i +'_5></span>'
				
				text += '<div class="d-flex justify-content-between align-items-center">';
				text += '<div class="btn-group">';
				text += '<button type="button" class="btn btn-sm btn-outline-secondary" onclick=onclick_goRate(event) data-toggle="modal" data-target="#myModal" id="' + i + '">Rate</button>';
				text += '</div>';
				text += '<small class="text-muted">Ingredients: '+response[i]["ingredient"]+'</small>';
				text += '</div></div></div></div>';
			}
			document.getElementById("custom_content").innerHTML=text;
			}
			
			$.ajax({
				methos:"GET",
				url:"../menu/view_rating/getScoreavg.php"	
			}).done(function(response){
				console.log(response);
				
				if (response!=null){
					for(var i =0;i<response.length;i++){
						color_star(i,response[i]["rating"]);
					}
				}
			});
		});
		
		var btnId='';
		
		function color_star(card,star){
			document.getElementById("star"+card+'_1').style["color"]="black";
			document.getElementById("star"+card+'_2').style["color"]="black";
			document.getElementById("star"+card+'_3').style["color"]="black";
			document.getElementById("star"+card+'_4').style["color"]="black";
			document.getElementById("star"+card+'_5').style["color"]="black";
			console.log(star);
			
			for(var i=1; i<=star; i++){
				var starno = document.getElementById("star"+card+'_'+i);
				console.log("star"+card+'_'+i);
				console.log(starno);
				starno.style["color"]="orange";
			}
		}
		
		function onclick_goRate(event){
			btnId=event.target.id;
		}
		
		function onclick_sumit(event){
			$.ajax({
				method:"GET",
				url:"../menu/uploadRating.php",
				data:{id:btnId,score:score}
			}).done(function(response){
				console.log(response);
				location.reload();
			})
		}
	</script>
	
	
	<script>
	var star1= document.getElementById("btn_star1");
	var star2= document.getElementById("btn_star2");
	var star3= document.getElementById("btn_star3");
	var star4= document.getElementById("btn_star4");
	var star5= document.getElementById("btn_star5");
	var sumit= document.getElementById("sumit");
	
	var score=0;
	function onclick_star_a(event){
			star1.style["color"]="orange";
			star2.style["color"]="black";
			star3.style["color"]="black";
			star4.style["color"]="black";
			star5.style["color"]="black";
			score=1;
	}
	function onclick_star_b(event){
		star1.style["color"]="orange";
		star2.style["color"]="orange";
		star3.style["color"]="black";
		star4.style["color"]="black";
		star5.style["color"]="black";
		score=2;
	}
	function onclick_star_c(event){
		star1.style["color"]="orange";
		star2.style["color"]="orange";
		star3.style["color"]="orange";
		star4.style["color"]="black";
		star5.style["color"]="black";
		score=3;
	}
	function onclick_star_d(event){
		star1.style["color"]="orange";
		star2.style["color"]="orange";
		star3.style["color"]="orange";
		star4.style["color"]="orange";
		star5.style["color"]="black";
		score=4;
	}
	function onclick_star_e(event){
		star1.style["color"]="orange";
		star2.style["color"]="orange";
		star3.style["color"]="orange";
		star4.style["color"]="orange";
		star5.style["color"]="orange";
		score=5;
	}
	
</script>
  </body>
</html>
